<div class="chat-container">
  <div class="chat-header">
    <h2><i class="fas fa-robot"></i> Monoprix Assistant</h2>
    <div class="chat-status" [ngClass]="{'online': isOnline, 'offline': !isOnline}">
      {{ isOnline ? 'En ligne' : 'Hors ligne' }}
    </div>
  </div>

  <div id="chat-box" #chatBox>
    <div *ngFor="let msg of chatMessages" [class]="msg.sender + '-message'">
      <div class="message-content">
        <div class="message-text">{{ msg.text }}</div>
        <div *ngIf="msg.sender === 'bot'" class="message-meta">
          <span class="confidence" *ngIf="msg.confidence !== undefined">
            Confiance : {{ msg.confidence | percent:'1.0-0' }}
          </span>
          <span class="message-time">{{ msg.timestamp | date:'shortTime' }}</span>
        </div>
      </div>
    </div>
    <div *ngIf="isLoading" class="typing-indicator">
      <span></span><span></span><span></span>
    </div>
  </div>

  <div class="input-container">
    <input
      type="text"
      [(ngModel)]="userInput"
      (keydown.enter)="sendMessage()"
      placeholder="Posez votre question..."
      [disabled]="!isOnline || isLoading"
      #chatInput
    />
    <button
      (click)="sendMessage()"
      [disabled]="!userInput.trim() || !isOnline || isLoading"
      class="send-button"
    >
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
</div>
